{"version":3,"sources":["service/_config.js","components/CyclingList.js","_config.js","components/BikeStationInfo.js","assets/venue_location_icon.svg","assets/here_location_icon.svg","components/Map/VenueLocationIcon.js","components/Map/Markers.js","components/Map/MapView.js","components/Cycling.js","App.js","index.js"],"names":["getAuthorizationHeader","GMTString","Date","toGMTString","ShaObj","jsSHA","setHMACKey","update","getHMAC","CyclingList","list","handleClick","map","item","index","Paper","style","padding","marginTop","onClick","RouteName","Divider","margin","display","RoadSectionStart","RoadSectionEnd","fontSize","fontWeight","color","border","borderRadius","marginLeft","textAlign","paddingTop","CyclingLength","serviceStatusConfig","text","BikeStationInfo","bikeStationUid","React","useState","bikeStationInfo","setbikeStationInfo","useEffect","pro1","a","axios","method","url","headers","pro2","Promise","all","then","response","info","forEach","res","data","catch","err","console","log","setChip","type","value","Chip","size","label","StationName","Zh_tw","AuthorityID","ServiceStatus","ServiceType","flexGrow","backgroundColor","AvailableRentBikes","AvailableReturnBikes","UpdateTime","replace","VenueLocationIcon","L","icon","iconUrl","hereIcon","iconRetinaUrl","iconAnchor","shadowUrl","shadowSize","shadowAnchor","iconSize","className","Markers","markers","setbikeStationUid","useMap","locations","setlocations","mapCenter","getCenter","lat","lng","uid","StationUID","name","position","StationPosition","PositionLat","PositionLon","Marker","eventHandlers","click","e","Popup","LocationMarker","showCurrentLocation","setPosition","locate","on","latlng","flyTo","getZoom","SetFlyto","flyto","MapView","polyline","showNearbyBikes","setflyto","MapContainer","center","zoom","TileLayer","attribution","Polyline","pathOptions","positions","Cycling","cyclingList","setcyclingList","setmarkers","setpolyline","setshowCurrentLocation","setshowNearbyBikes","width","height","top","left","zIndex","Geometry","line","split","x","y","parseFloat","reverse","length","bottom","right","IconButton","App","CssBaseline","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.4d7f0d91.chunk.js","sourcesContent":["import jsSHA from 'jssha'\r\n//--------------------\r\nexport function getAuthorizationHeader() {\r\n  let AppID = '125f67eef61d44189819c6378e4da9cb';\r\n  let AppKey = 'Pn9PITNbREc7_yBevt-7udS0UOE';\r\n  let GMTString = new Date().toGMTString();\r\n  let ShaObj = new jsSHA('SHA-1', 'TEXT');\r\n  ShaObj.setHMACKey(AppKey, 'TEXT');\r\n  ShaObj.update('x-date: ' + GMTString);\r\n  let HMAC = ShaObj.getHMAC('B64');\r\n  let Authorization = 'hmac username=\"' + AppID + '\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"' + HMAC + '\"';\r\n  return { 'Authorization': Authorization, 'X-Date': GMTString };\r\n}","// MUI\r\nimport Paper from '@mui/material/Paper';\r\nimport Divider from '@mui/material/Divider';\r\n//--------------------\r\nexport default function CyclingList({ list, handleClick }) {\r\n\r\n    return (list.map((item, index) =>\r\n        <Paper key={index} style={{ padding: '16px', marginTop: index === 0 ? '0' : '10px' }}\r\n            onClick={() => handleClick(item)}\r\n        >\r\n            <h3>{item.RouteName}</h3>\r\n            <Divider style={{ margin: '4px auto' }} />\r\n            <div style={{ display: 'flex' }}>\r\n                {(item.RoadSectionStart || item.RoadSectionEnd) &&\r\n                    <div>\r\n                        {item.RoadSectionStart &&\r\n                            <div style={{ margin: '12px auto' }}>\r\n                                <span style={{ fontSize: '10px', fontWeight: 'bold', color: 'red', padding: '4px', border: 'solid 3px red', borderRadius: '50%' }}>起</span>\r\n                                <span style={{ fontSize: '12px', marginLeft: '4px' }}>{item.RoadSectionStart}</span>\r\n                            </div>\r\n                        }\r\n                        {item.RoadSectionStart &&\r\n                            <div>\r\n                                <span style={{ fontSize: '10px', fontWeight: 'bold', color: 'red', padding: '4px', border: 'solid 3px red', borderRadius: '50%' }}>迄</span>\r\n                                <span style={{ fontSize: '12px', marginLeft: '4px' }}>{item.RoadSectionEnd}</span>\r\n                            </div>\r\n                        }\r\n                    </div>\r\n                }\r\n                <div style={{ margin: 'auto 0 auto auto', textAlign: 'center' }}>\r\n                    <p style={{ fontSize: '10px', paddingTop: '16px' }} >全長</p>\r\n                    <p style={{ fontWeight: 'bold', color: 'red' }}>{item.CyclingLength} 公里</p>\r\n                </div>\r\n            </div>\r\n        </Paper >\r\n    ))\r\n}","export const serviceStatusConfig = [\r\n    { color: 'red', text: '停止營運' },\r\n    { color: 'green', text: '正常營運' },\r\n    { color: 'yellow', text: '暫停營運' },\r\n];","import React from 'react'\r\nimport axios from 'axios'\r\n// MUI\r\nimport Paper from '@mui/material/Paper';\r\nimport Divider from '@mui/material/Divider';\r\nimport Chip from '@mui/material/Chip';\r\n// Custom\r\nimport { getAuthorizationHeader } from 'src/service/_config'\r\nimport { serviceStatusConfig } from 'src/_config'\r\n//--------------------\r\nexport default function BikeStationInfo({ bikeStationUid }) {\r\n    const [bikeStationInfo, setbikeStationInfo] = React.useState();\r\n\r\n    React.useEffect(() => {\r\n        const pro1 = (async () => await axios({\r\n            method: 'get',\r\n            url: `https://ptx.transportdata.tw/MOTC/v2/Bike/Station/Taipei?$filter=StationUID%20eq%20%27${bikeStationUid}%27&$top=1&$format=JSON`,\r\n            headers: getAuthorizationHeader()\r\n        }))();\r\n\r\n        const pro2 = (async () => await axios({\r\n            method: 'get',\r\n            url: `https://ptx.transportdata.tw/MOTC/v2/Bike/Availability/Taipei?$filter=StationUID%20eq%20%27${bikeStationUid}%27&$top=1&$format=JSON`,\r\n            headers: getAuthorizationHeader()\r\n        }))();\r\n\r\n        Promise.all([pro1, pro2]).then(response => {\r\n            let info;\r\n            response.forEach(res => { info = { ...info, ...res.data[0] } })\r\n            setbikeStationInfo(info);\r\n        }).catch(err => console.log(err))\r\n\r\n    }, [bikeStationUid]);\r\n\r\n    const setChip = (type, value) => {\r\n        let data;\r\n        switch (type) {\r\n            case \"serviceStatus\":\r\n                data = serviceStatusConfig[value];\r\n                break;\r\n            case \"serviceType\":\r\n                data = { text: `YouBike${value}.0` };\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        return <Chip size=\"small\" label={<p>{data.color && <span style={{ color: data.color }}>● </span>}{data.text}</p>} />;\r\n    }\r\n\r\n    return bikeStationInfo ?\r\n        <Paper style={{ padding: '16px' }}>\r\n            <h3>{bikeStationInfo.StationName.Zh_tw}</h3>\r\n            <p>{bikeStationInfo.AuthorityID}</p>\r\n            <Divider style={{ margin: '8px auto' }} />\r\n            <div>\r\n                {setChip(\"serviceStatus\", bikeStationInfo.ServiceStatus)}\r\n                <span style={{ marginLeft: '8px' }}></span>\r\n                {setChip(\"serviceType\", bikeStationInfo.ServiceType)}\r\n            </div>\r\n            <div style={{ display: 'flex', marginTop: '8px', textAlign: 'center' }}>\r\n                <p style={{ flexGrow: 1, padding: '8px', backgroundColor: '#dbf0d2', color: 'green', borderRadius: '4px 0 0 4px' }}>\r\n                    可租 <span style={{ fontWeight: 'bold' }}>{bikeStationInfo.AvailableRentBikes}</span>\r\n                </p>\r\n                <p style={{ flexGrow: 1, padding: '8px', backgroundColor: 'green', color: '#fff', borderRadius: '0 4px 4px 0' }}>\r\n                    可還 <span style={{ fontWeight: 'bold' }}>{bikeStationInfo.AvailableReturnBikes}</span>\r\n                </p>\r\n            </div>\r\n            <small>更新時間：{bikeStationInfo.UpdateTime.replace(\"T\", \" \").replace(/\\+\\d*\\:\\d*/, \"\")}</small>\r\n        </Paper > : null\r\n}","export default __webpack_public_path__ + \"static/media/venue_location_icon.1b60bdb7.svg\";","export default __webpack_public_path__ + \"static/media/here_location_icon.a67deb53.svg\";","import L from 'leaflet';\r\nimport icon from 'src/assets/venue_location_icon.svg'\r\nimport hereIcon from 'src/assets/here_location_icon.svg'\r\n\r\nconst VenueLocationIcon = type => L.icon({\r\n    iconUrl: type === 'here' ? hereIcon : icon,\r\n    iconRetinaUrl: type === 'here' ? hereIcon : icon,\r\n    iconAnchor: null,\r\n    shadowUrl: null,\r\n    shadowSize: null,\r\n    shadowAnchor: null,\r\n    iconSize: [35, 35],\r\n    className: 'leaflet-venue-icon'\r\n});\r\nexport default VenueLocationIcon;","import React from 'react';\r\nimport axios from 'axios'\r\nimport 'leaflet/dist/leaflet.css';\r\nimport {\r\n    Marker,\r\n    Popup,\r\n    useMap,\r\n} from 'react-leaflet';\r\n// Custom\r\nimport VenueLocationIcon from 'src/components/Map/VenueLocationIcon';\r\nimport { getAuthorizationHeader } from 'src/service/_config'\r\n//--------------------\r\nconst icon = VenueLocationIcon();\r\n\r\nexport default function Markers({ markers, type, setbikeStationUid }) {\r\n    const map = useMap();\r\n    const [locations, setlocations] = React.useState(markers);\r\n\r\n    React.useEffect(() => {\r\n        if (map && type) {\r\n            const mapCenter = map.getCenter();\r\n            const lat = mapCenter.lat;\r\n            const lng = mapCenter.lng;\r\n            const top = 30;\r\n\r\n            switch (type[0]) {\r\n                case 'bike':\r\n                    (async () => await axios({\r\n                        method: 'get',\r\n                        url: `https://ptx.transportdata.tw/MOTC/v2/Bike/Station/NearBy?$top=${top}&$spatialFilter=nearby(${lat}%2C%20${lng}%2C%201000)&$format=JSON`,\r\n                        headers: getAuthorizationHeader()\r\n                    }))().then(res => {\r\n                        const list = res.data.map(item => {\r\n                            return {\r\n                                uid: item.StationUID,\r\n                                name: item.StationName.Zh_tw,\r\n                                position: [item.StationPosition.PositionLat, item.StationPosition.PositionLon],\r\n                            }\r\n                        });\r\n                        setlocations(list);\r\n                    }).catch(err => console.log(err))\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }, [map, type]);\r\n\r\n    return locations ? locations.map((item, index) => (\r\n        <Marker key={index} position={item.position} icon={icon}\r\n            eventHandlers={{\r\n                click: e => {\r\n                    setbikeStationUid(item.uid)\r\n                },\r\n            }}\r\n        >\r\n            {item.name && <Popup>{item.name}</Popup>}\r\n        </Marker>\r\n    )) : null\r\n}","import React, { useEffect, useState } from 'react';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport {\r\n    MapContainer,\r\n    TileLayer,\r\n    Marker,\r\n    Polyline,\r\n    Popup,\r\n    useMap,\r\n} from 'react-leaflet';\r\n// Custom\r\nimport Markers from 'src/components/Map/Markers';\r\nimport VenueLocationIcon from 'src/components/Map/VenueLocationIcon';\r\nimport 'src/components/Map/MapView.css'\r\n//--------------------\r\nconst hereIcon = VenueLocationIcon('here');\r\n\r\nfunction LocationMarker({ showCurrentLocation }) {\r\n    const map = useMap();\r\n    const [position, setPosition] = useState(null);\r\n\r\n    useEffect(() => {\r\n        if (map && showCurrentLocation) {\r\n            map.locate().on(\"locationfound\", function (e) {\r\n                setPosition(e.latlng);\r\n                map.flyTo(e.latlng, map.getZoom());\r\n            });\r\n        }\r\n    }, [map, showCurrentLocation]);\r\n\r\n    return position === null ? null : (\r\n        <Marker position={position} icon={hereIcon}>\r\n            <Popup>現在位置</Popup>\r\n        </Marker>\r\n    );\r\n}\r\n\r\nfunction SetFlyto({ flyto }) {\r\n    const map = useMap();\r\n\r\n    useEffect(() => {\r\n        if (map && flyto) {\r\n            map.flyTo(flyto, map.getZoom())\r\n        }\r\n    }, [map, flyto]);\r\n\r\n    return null\r\n}\r\n\r\nexport default function MapView({\r\n    markers,\r\n    polyline,\r\n    showCurrentLocation,\r\n    showNearbyBikes,\r\n    setbikeStationUid,\r\n}) {\r\n    const [flyto, setflyto] = useState();\r\n    const center = [25.04795444238345, 121.51693473083246]; // 台北車站\r\n\r\n    useEffect(() => {\r\n        if (polyline)\r\n            setflyto(polyline[0])\r\n    }, [polyline]);\r\n\r\n    return (\r\n        <MapContainer center={center} zoom={15}>\r\n            {flyto && <SetFlyto flyto={flyto} />}\r\n            <TileLayer\r\n                attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n            />\r\n            {markers && <Markers markers={markers} />}\r\n            {polyline && <Polyline pathOptions={{ color: 'red' }} positions={polyline} />}\r\n            {showCurrentLocation && <LocationMarker showCurrentLocation={showCurrentLocation} />}\r\n            {showNearbyBikes && <Markers type={['bike']} setbikeStationUid={setbikeStationUid} />}\r\n        </MapContainer >\r\n    )\r\n}","import React from 'react'\r\nimport axios from 'axios'\r\n// MUI\r\nimport IconButton from '@mui/material/IconButton';\r\nimport GpsFixedIcon from '@mui/icons-material/GpsFixed';\r\nimport PedalBikeIcon from '@mui/icons-material/PedalBike';\r\n// Custom\r\nimport { getAuthorizationHeader } from 'src/service/_config'\r\nimport CyclingList from 'src/components/CyclingList';\r\nimport BikeStationInfo from 'src/components/BikeStationInfo';\r\nimport MapView from 'src/components/Map/MapView';\r\n//--------------------\r\nexport default function Cycling() {\r\n    const [cyclingList, setcyclingList] = React.useState();\r\n    const [markers, setmarkers] = React.useState();\r\n    const [polyline, setpolyline] = React.useState();\r\n    const [showCurrentLocation, setshowCurrentLocation] = React.useState();\r\n    const [showNearbyBikes, setshowNearbyBikes] = React.useState(false);\r\n    const [bikeStationUid, setbikeStationUid] = React.useState('');\r\n\r\n    React.useEffect(() => {\r\n        (async () => await axios({\r\n            method: 'get',\r\n            url: `https://ptx.transportdata.tw/MOTC/v2/Cycling/Shape/Taipei?$top=4&$format=JSON`,\r\n            headers: getAuthorizationHeader()\r\n        }))().then(res => {\r\n            setcyclingList(res.data);\r\n        }).catch(err => console.log(err))\r\n    }, []);\r\n\r\n    const handleClick = data => {\r\n        if (data.Geometry) {\r\n            let line = data.Geometry\r\n                .replace(/(MULTILINESTRING\\s\\(\\()|(\\)\\))/g, '')\r\n                .split(',')\r\n                .map(x => x\r\n                    .split(' ')\r\n                    .map(y => parseFloat(y)).reverse()\r\n                );\r\n\r\n            setpolyline(line)\r\n            setmarkers([\r\n                { name: data.RoadSectionStart, position: line[0] },\r\n                { name: data.RoadSectionEnd, position: line[line.length - 1] },\r\n            ]);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div style={{ position: 'relative', width: '100%', height: '100%' }}>\r\n            {/* 自行車道列表 */}\r\n            <div style={{ position: 'absolute', top: 8, left: 8, zIndex: 401 }}>\r\n                {cyclingList && <CyclingList list={cyclingList} handleClick={handleClick} />}\r\n            </div>\r\n            {bikeStationUid &&\r\n                <div style={{ position: 'absolute', bottom: 8, right: 8, zIndex: 401, width: '50%' }}>\r\n                    <BikeStationInfo bikeStationUid={bikeStationUid} />\r\n                </div>\r\n            }\r\n\r\n            {/* button group */}\r\n            <div style={{ position: 'absolute', top: 8, right: 8, zIndex: 401 }}>\r\n                <div style={{ backgroundColor: '#fff', borderRadius: '50%' }} >\r\n                    <IconButton color=\"primary\" aria-label=\"add to shopping cart\" onClick={() => setshowNearbyBikes([])}>\r\n                        <PedalBikeIcon />\r\n                    </IconButton>\r\n                </div>\r\n                <div style={{ marginTop: '8px' }} />\r\n                <div style={{ backgroundColor: '#fff', borderRadius: '50%' }} >\r\n                    <IconButton color=\"primary\" aria-label=\"add to shopping cart\" onClick={() => setshowCurrentLocation([])}>\r\n                        <GpsFixedIcon />\r\n                    </IconButton>\r\n                </div>\r\n            </div>\r\n            {/* Leaflet 地圖 */}\r\n            <MapView\r\n                markers={markers}\r\n                polyline={polyline}\r\n                showCurrentLocation={showCurrentLocation}\r\n                showNearbyBikes={showNearbyBikes}\r\n                setbikeStationUid={setbikeStationUid}\r\n            />\r\n        </div>\r\n    )\r\n}","import React from 'react'\r\n// MUI\r\nimport CssBaseline from '@mui/material/CssBaseline';\r\n// Custom\r\nimport Cycling from 'src/components/Cycling';\r\nimport 'src/App.css'\r\n//--------------------\r\nfunction App() {\r\n  return (\r\n    <div style={{padding:'10px', width:'100wh',height:'100vh'}}>\r\n      <CssBaseline />\r\n      <Cycling />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}